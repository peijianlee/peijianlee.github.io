{"_path":"/posts/20211028","_dir":"posts","_draft":false,"_partial":false,"_locale":"","title":"å‰ç«¯å¾®æœåŠ¡-qiankunå®‰è£…ä¸é…ç½®","description":"","navigation":{"title":"å‰ç«¯å¾®æœåŠ¡-qiankunå®‰è£…ä¸é…ç½®","description":"qiankun å­µåŒ–è‡ªèš‚èšé‡‘èç§‘æŠ€åŸºäºå¾®å‰ç«¯æ¶æ„çš„äº‘äº§å“ç»Ÿä¸€æ¥å…¥å¹³å°ï¼Œåœ¨ç»è¿‡ä¸€æ‰¹çº¿ä¸Šåº”ç”¨çš„å……åˆ†æ£€éªŒåŠæ‰“ç£¨åï¼Œæˆ‘ä»¬å°†å…¶å¾®å‰ç«¯å†…æ ¸æŠ½å–å‡ºæ¥å¹¶å¼€æºï¼Œå¸Œæœ›èƒ½åŒæ—¶å¸®åŠ©ç¤¾åŒºæœ‰ç±»ä¼¼éœ€æ±‚çš„ç³»ç»Ÿæ›´æ–¹ä¾¿çš„æ„å»ºè‡ªå·±çš„å¾®å‰ç«¯ç³»ç»Ÿï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›é€šè¿‡ç¤¾åŒºçš„å¸®åŠ©å°† qiankun æ‰“ç£¨çš„æ›´åŠ æˆç†Ÿå®Œå–„ã€‚","date":"2021-10-28 10:20:00","account":"lpj","tags":["å‰ç«¯å¾®æœåŠ¡","ä¹¾å¤"]},"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"ä»‹ç»"},"children":[{"type":"text","value":"ä»‹ç»"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"qiankun æ˜¯ä¸€ä¸ªåŸºäº "},{"type":"element","tag":"a","props":{"href":"https://github.com/CanopyTax/single-spa","rel":["nofollow"]},"children":[{"type":"text","value":"single-spa"}]},{"type":"text","value":" çš„"},{"type":"element","tag":"a","props":{"href":"https://micro-frontends.org/","rel":["nofollow"]},"children":[{"type":"text","value":"å¾®å‰ç«¯å®"}]},{"type":"text","value":"ç°åº“ï¼Œæ—¨åœ¨å¸®åŠ©å¤§å®¶èƒ½æ›´ç®€å•ã€æ— ç—›çš„æ„å»ºä¸€ä¸ªç”Ÿäº§å¯ç”¨å¾®å‰ç«¯æ¶æ„ç³»ç»Ÿã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"qiankun å­µåŒ–è‡ªèš‚èšé‡‘èç§‘æŠ€åŸºäºå¾®å‰ç«¯æ¶æ„çš„äº‘äº§å“ç»Ÿä¸€æ¥å…¥å¹³å°ï¼Œåœ¨ç»è¿‡ä¸€æ‰¹çº¿ä¸Šåº”ç”¨çš„å……åˆ†æ£€éªŒåŠæ‰“ç£¨åï¼Œæˆ‘ä»¬å°†å…¶å¾®å‰ç«¯å†…æ ¸æŠ½å–å‡ºæ¥å¹¶å¼€æºï¼Œå¸Œæœ›èƒ½åŒæ—¶å¸®åŠ©ç¤¾åŒºæœ‰ç±»ä¼¼éœ€æ±‚çš„ç³»ç»Ÿæ›´æ–¹ä¾¿çš„æ„å»ºè‡ªå·±çš„å¾®å‰ç«¯ç³»ç»Ÿï¼ŒåŒæ—¶ä¹Ÿå¸Œæœ›é€šè¿‡ç¤¾åŒºçš„å¸®åŠ©å°† qiankun æ‰“ç£¨çš„æ›´åŠ æˆç†Ÿå®Œå–„ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ç›®å‰ qiankun å·²åœ¨èš‚èšå†…éƒ¨æœåŠ¡äº†è¶…è¿‡ 200+ çº¿ä¸Šåº”ç”¨ï¼Œåœ¨æ˜“ç”¨æ€§åŠå®Œå¤‡æ€§ä¸Šï¼Œç»å¯¹æ˜¯å€¼å¾—ä¿¡èµ–çš„ã€‚"}]},{"type":"element","tag":"h2","props":{"id":"_1ä¸»åº”ç”¨"},"children":[{"type":"text","value":"1ã€ä¸»åº”ç”¨"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä¸»åº”ç”¨ä¸é™æŠ€æœ¯æ ˆï¼Œåªéœ€è¦æä¾›ä¸€ä¸ªå®¹å™¨ DOMï¼Œç„¶åæ³¨å†Œå¾®åº”ç”¨å¹¶ start å³å¯ã€‚"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"å…ˆå®‰è£… "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"qiankun"}]},{"type":"text","value":" ï¼š"}]},{"type":"element","tag":"pre","props":{"className":["language-js"],"code":"$ yarn add qiankun # æˆ–è€… npm i qiankun -S\n","language":"js","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"$ yarn add qiankun # æˆ–è€… npm i qiankun -S\n"}]}]},{"type":"element","tag":"h3","props":{"id":"_11æ³¨å†Œå¾®åº”ç”¨å¹¶å¯åŠ¨"},"children":[{"type":"text","value":"1.1ã€æ³¨å†Œå¾®åº”ç”¨å¹¶å¯åŠ¨ï¼š"}]},{"type":"element","tag":"pre","props":{"className":["language-js"],"code":"import { registerMicroApps, start } from 'qiankun';\n\nregisterMicroApps([\n  {\n    name: 'reactApp',\n    entry: '//localhost:3000',\n    container: '#container',\n    activeRule: '/app-react',\n  },\n  {\n    name: 'vueApp',\n    entry: '//localhost:8080',\n    container: '#container',\n    activeRule: '/app-vue',\n  },\n  {\n    name: 'angularApp',\n    entry: '//localhost:4200',\n    container: '#container',\n    activeRule: '/app-angular',\n  },\n]);\n// å¯åŠ¨ qiankun\nstart();\n","language":"js","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"import { registerMicroApps, start } from 'qiankun';\n\nregisterMicroApps([\n  {\n    name: 'reactApp',\n    entry: '//localhost:3000',\n    container: '#container',\n    activeRule: '/app-react',\n  },\n  {\n    name: 'vueApp',\n    entry: '//localhost:8080',\n    container: '#container',\n    activeRule: '/app-vue',\n  },\n  {\n    name: 'angularApp',\n    entry: '//localhost:4200',\n    container: '#container',\n    activeRule: '/app-angular',\n  },\n]);\n// å¯åŠ¨ qiankun\nstart();\n"}]}]},{"type":"element","tag":"h2","props":{"id":"_2vue-å¾®åº”ç”¨"},"children":[{"type":"text","value":"2ã€Vue å¾®åº”ç”¨"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä»¥ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"vue-cli 3+"}]},{"type":"text","value":" ç”Ÿæˆçš„ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"vue 2.x"}]},{"type":"text","value":" é¡¹ç›®ä¸ºä¾‹"}]},{"type":"element","tag":"h3","props":{"id":"_21åœ¨-src-ç›®å½•æ–°å¢-public-pathjs"},"children":[{"type":"text","value":"2.1ã€åœ¨ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"src"}]},{"type":"text","value":" ç›®å½•æ–°å¢ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"public-path.js"}]},{"type":"text","value":"ï¼š"}]},{"type":"element","tag":"pre","props":{"className":["language-js"],"code":"if (window.__POWERED_BY_QIANKUN__) {\n  __webpack_public_path__ = window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__;\n}\n","language":"js","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"if (window.__POWERED_BY_QIANKUN__) {\n  __webpack_public_path__ = window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__;\n}\n"}]}]},{"type":"element","tag":"h3","props":{"id":"_22å…¥å£æ–‡ä»¶-mainjs-ä¿®æ”¹ä¸ºäº†é¿å…æ ¹-id-app-ä¸å…¶ä»–çš„-dom-å†²çªéœ€è¦é™åˆ¶æŸ¥æ‰¾èŒƒå›´"},"children":[{"type":"text","value":"2.2ã€å…¥å£æ–‡ä»¶ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"main.js"}]},{"type":"text","value":" ä¿®æ”¹ï¼Œä¸ºäº†é¿å…æ ¹ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"id #app"}]},{"type":"text","value":" ä¸å…¶ä»–çš„ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DOM"}]},{"type":"text","value":" å†²çªï¼Œéœ€è¦é™åˆ¶æŸ¥æ‰¾èŒƒå›´ã€‚"}]},{"type":"element","tag":"pre","props":{"className":["language-js"],"code":"// new Vue({\n//   router,\n//   store,\n//   render: h => h(App)\n// }).$mount('#app')\n\n// ä¹¾å¤é…ç½®æ–¹æ³•\nlet instance = null\nfunction render( props = {}) {\n    const { container } = props\n    instance = new Vue({\n        router,\n        store,\n        render: h => h(App),\n    }).$mount(container ? container.querySelector('#app'): '#app')\n}\n\nif (!window.__POWERED_BY_QIANKUN__) {\n    render()\n}\n\n//--------- ç”Ÿå‘½å‘¨æœŸå‡½æ•°------------//\nexport async function bootstrap() {\n    console.log('[qiankun] vue app bootstraped')\n}\nexport async function mount(props) {\n    console.log('[qiankun] props from main framework', props)\n    render(props)\n}\nexport async function unmount() {\n    instance.$destroy()\n    instance.$el.innerHTML = ''\n    instance = null\n}\n\n","language":"js","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// new Vue({\n//   router,\n//   store,\n//   render: h => h(App)\n// }).$mount('#app')\n\n// ä¹¾å¤é…ç½®æ–¹æ³•\nlet instance = null\nfunction render( props = {}) {\n    const { container } = props\n    instance = new Vue({\n        router,\n        store,\n        render: h => h(App),\n    }).$mount(container ? container.querySelector('#app'): '#app')\n}\n\nif (!window.__POWERED_BY_QIANKUN__) {\n    render()\n}\n\n//--------- ç”Ÿå‘½å‘¨æœŸå‡½æ•°------------//\nexport async function bootstrap() {\n    console.log('[qiankun] vue app bootstraped')\n}\nexport async function mount(props) {\n    console.log('[qiankun] props from main framework', props)\n    render(props)\n}\nexport async function unmount() {\n    instance.$destroy()\n    instance.$el.innerHTML = ''\n    instance = null\n}\n\n"}]}]},{"type":"element","tag":"h3","props":{"id":"_23é…ç½®-vueconfigjs"},"children":[{"type":"text","value":"2.3ã€é…ç½® "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"vue.config.js"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"åœ¨å­é¡¹ç›®å†…ä¿®æ”¹ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"vue.config.js"}]}]},{"type":"element","tag":"pre","props":{"className":["language-js"],"code":"const path = require('path');\nconst { name } = require('./package');\n\nfunction resolve(dir) {\n    return path.join(__dirname, dir);\n}\n\nconst port = 8092; // dev port\n\nmodule.exports = {\n  /**\n   * You will need to set publicPath if you plan to deploy your site under a sub path,\n   * for example GitHub Pages. If you plan to deploy your site to https://foo.github.io/bar/,\n   * then publicPath should be set to \"/bar/\".\n   * In most cases please use '/' !!!\n   * Detail: https://cli.vuejs.org/config/#publicpath\n   */\n    // åŸºæœ¬è·¯å¾„\n    publicPath: process.env.publicPath != null && process.env.publicPath != '' ? process.env.publicPath : '/',\n    outputDir: process.env.outputDir != null && process.env.outputDir != '' ? process.env.outputDir : 'dist',\n    filenameHashing: true,\n    // tweak internal webpack configuration.\n    // see https://github.com/vuejs/vue-cli/blob/dev/docs/webpack.md\n    devServer: {\n        // host: '0.0.0.0',\n        hot: true,\n        disableHostCheck: true,\n        port,\n        // overlay: {\n        //     warnings: false,\n        //     errors: true,\n        // },\n        headers: {\n            'Access-Control-Allow-Origin': '*',\n        },\n    },\n    // è‡ªå®šä¹‰webpacké…ç½®\n    configureWebpack: {\n        resolve: {\n            alias: {\n                // '@': window.__POWERED_BY_QIANKUN__? resolve('/naroticControl/src'): resolve('/src'),\n                '@': resolve('/src'),\n            },\n        },\n        output: {\n            // æŠŠå­åº”ç”¨æ‰“åŒ…æˆ umd åº“æ ¼å¼\n            library: `${name}-[name]`,\n            libraryTarget: 'umd',\n            jsonpFunction: `webpackJsonp_${name}`,\n        },\n    },\n};\n","language":"js","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const path = require('path');\nconst { name } = require('./package');\n\nfunction resolve(dir) {\n    return path.join(__dirname, dir);\n}\n\nconst port = 8092; // dev port\n\nmodule.exports = {\n  /**\n   * You will need to set publicPath if you plan to deploy your site under a sub path,\n   * for example GitHub Pages. If you plan to deploy your site to https://foo.github.io/bar/,\n   * then publicPath should be set to \"/bar/\".\n   * In most cases please use '/' !!!\n   * Detail: https://cli.vuejs.org/config/#publicpath\n   */\n    // åŸºæœ¬è·¯å¾„\n    publicPath: process.env.publicPath != null && process.env.publicPath != '' ? process.env.publicPath : '/',\n    outputDir: process.env.outputDir != null && process.env.outputDir != '' ? process.env.outputDir : 'dist',\n    filenameHashing: true,\n    // tweak internal webpack configuration.\n    // see https://github.com/vuejs/vue-cli/blob/dev/docs/webpack.md\n    devServer: {\n        // host: '0.0.0.0',\n        hot: true,\n        disableHostCheck: true,\n        port,\n        // overlay: {\n        //     warnings: false,\n        //     errors: true,\n        // },\n        headers: {\n            'Access-Control-Allow-Origin': '*',\n        },\n    },\n    // è‡ªå®šä¹‰webpacké…ç½®\n    configureWebpack: {\n        resolve: {\n            alias: {\n                // '@': window.__POWERED_BY_QIANKUN__? resolve('/naroticControl/src'): resolve('/src'),\n                '@': resolve('/src'),\n            },\n        },\n        output: {\n            // æŠŠå­åº”ç”¨æ‰“åŒ…æˆ umd åº“æ ¼å¼\n            library: `${name}-[name]`,\n            libraryTarget: 'umd',\n            jsonpFunction: `webpackJsonp_${name}`,\n        },\n    },\n};\n"}]}]},{"type":"element","tag":"h3","props":{"id":"_24é…ç½®å­é¡¹ç›®çš„-router"},"children":[{"type":"text","value":"2.4ã€é…ç½®å­é¡¹ç›®çš„ router"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ä¿®æ”¹è¾“å‡ºçš„ç›®å½•ï¼Œéœ€è¦å’Œä¸»åº”ç”¨çš„ "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"activeRule"}]},{"type":"text","value":" ä¸€è‡´"}]},{"type":"element","tag":"pre","props":{"className":["language-js"],"code":"const router = new VueRouter({\n    mode: 'history',\n    base: window.__POWERED_BY_QIANKUN__? '/app-vue/': process.env.BASE_URL,\n    routes\n})\n","language":"js","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"const router = new VueRouter({\n    mode: 'history',\n    base: window.__POWERED_BY_QIANKUN__? '/app-vue/': process.env.BASE_URL,\n    routes\n})\n"}]}]},{"type":"element","tag":"h2","props":{"id":"ä¸ºä»€ä¹ˆä¸æ˜¯-iframe"},"children":[{"type":"text","value":"ä¸ºä»€ä¹ˆä¸æ˜¯ iframe"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"çœ‹è¿™é‡Œ "},{"type":"element","tag":"a","props":{"href":"https://www.yuque.com/kuitos/gky7yw/gesexv","rel":["nofollow"]},"children":[{"type":"text","value":"Why Not Iframe"}]}]},{"type":"element","tag":"h2","props":{"id":"ç‰¹æ€§"},"children":[{"type":"text","value":"ç‰¹æ€§"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ğŸ“¦ åŸºäº "},{"type":"element","tag":"a","props":{"href":"https://github.com/CanopyTax/single-spa","rel":["nofollow"]},"children":[{"type":"text","value":"single-spa"}]},{"type":"text","value":" å°è£…ï¼Œæä¾›äº†æ›´åŠ å¼€ç®±å³ç”¨çš„ APIã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ğŸ“± æŠ€æœ¯æ ˆæ— å…³ï¼Œä»»æ„æŠ€æœ¯æ ˆçš„åº”ç”¨å‡å¯ ä½¿ç”¨/æ¥å…¥ï¼Œä¸è®ºæ˜¯ React/Vue/Angular/JQuery è¿˜æ˜¯å…¶ä»–ç­‰æ¡†æ¶ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ğŸ’ª HTML Entry æ¥å…¥æ–¹å¼ï¼Œè®©ä½ æ¥å…¥å¾®åº”ç”¨åƒä½¿ç”¨ iframe ä¸€æ ·ç®€å•ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ğŸ›¡â€‹ æ ·å¼éš”ç¦»ï¼Œç¡®ä¿å¾®åº”ç”¨ä¹‹é—´æ ·å¼äº’ç›¸ä¸å¹²æ‰°ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ğŸ§³ JS æ²™ç®±ï¼Œç¡®ä¿å¾®åº”ç”¨ä¹‹é—´ å…¨å±€å˜é‡/äº‹ä»¶ ä¸å†²çªã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"âš¡ï¸ èµ„æºé¢„åŠ è½½ï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´é¢„åŠ è½½æœªæ‰“å¼€çš„å¾®åº”ç”¨èµ„æºï¼ŒåŠ é€Ÿå¾®åº”ç”¨æ‰“å¼€é€Ÿåº¦ã€‚"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ğŸ”Œ umi æ’ä»¶ï¼Œæä¾›äº† "},{"type":"element","tag":"a","props":{"href":"https://github.com/umijs/plugins/tree/master/packages/plugin-qiankun","rel":["nofollow"]},"children":[{"type":"text","value":"@umijs/plugin-qiankun"}]},{"type":"text","value":" ä¾› umi åº”ç”¨ä¸€é”®åˆ‡æ¢æˆå¾®å‰ç«¯æ¶æ„ç³»ç»Ÿã€‚"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"ä»‹ç»","depth":2,"text":"ä»‹ç»"},{"id":"_1ä¸»åº”ç”¨","depth":2,"text":"1ã€ä¸»åº”ç”¨","children":[{"id":"_11æ³¨å†Œå¾®åº”ç”¨å¹¶å¯åŠ¨","depth":3,"text":"1.1ã€æ³¨å†Œå¾®åº”ç”¨å¹¶å¯åŠ¨ï¼š"}]},{"id":"_2vue-å¾®åº”ç”¨","depth":2,"text":"2ã€Vue å¾®åº”ç”¨","children":[{"id":"_21åœ¨-src-ç›®å½•æ–°å¢-public-pathjs","depth":3,"text":"2.1ã€åœ¨ src ç›®å½•æ–°å¢ public-path.jsï¼š"},{"id":"_22å…¥å£æ–‡ä»¶-mainjs-ä¿®æ”¹ä¸ºäº†é¿å…æ ¹-id-app-ä¸å…¶ä»–çš„-dom-å†²çªéœ€è¦é™åˆ¶æŸ¥æ‰¾èŒƒå›´","depth":3,"text":"2.2ã€å…¥å£æ–‡ä»¶ main.js ä¿®æ”¹ï¼Œä¸ºäº†é¿å…æ ¹ id #app ä¸å…¶ä»–çš„ DOM å†²çªï¼Œéœ€è¦é™åˆ¶æŸ¥æ‰¾èŒƒå›´ã€‚"},{"id":"_23é…ç½®-vueconfigjs","depth":3,"text":"2.3ã€é…ç½® vue.config.js"},{"id":"_24é…ç½®å­é¡¹ç›®çš„-router","depth":3,"text":"2.4ã€é…ç½®å­é¡¹ç›®çš„ router"}]},{"id":"ä¸ºä»€ä¹ˆä¸æ˜¯-iframe","depth":2,"text":"ä¸ºä»€ä¹ˆä¸æ˜¯ iframe"},{"id":"ç‰¹æ€§","depth":2,"text":"ç‰¹æ€§"}]}},"_type":"markdown","_id":"content:posts:20211028.md","_source":"content","_file":"posts/20211028.md","_stem":"posts/20211028","_extension":"md"}